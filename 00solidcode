// ============================================
// SOLID CODE - CODEWORKSHOP
// Generado: 9/1/2026, 11:39:38 a. m.
// Total de archivos: 7
// ============================================



// ============================================
// ARCHIVO 1/7: code.gs
// URL: https://raw.githubusercontent.com/koki81pe/CodeWorkShop/refs/heads/main/code.gs
// ============================================

/**
 * ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
 * ‚ïë PROYECTO: CodeWorkShop                                   ‚ïë
 * ‚ïë ARCHIVO: code.gs                                         ‚ïë
 * ‚ïë VERSI√ìN: 1.0.1                                          ‚ïë
 * ‚ïë FECHA: 09/01/2026 15:30 (UTC-5)                         ‚ïë
 * ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
 */

// MOD-001: FORZAR PERMISOS [INICIO]
/**
 * Esta funci√≥n DEBE ejecutarse manualmente una vez desde el editor
 * antes de desplegar la webapp para activar el flujo de autorizaci√≥n
 */
function forzarPermisos() {
  try {
    DriveApp.getRootFolder().getName();
  } catch (e) {
    Logger.log('Esperando autorizaci√≥n de Drive: ' + e);
  }
  
  try {
    SpreadsheetApp.getActiveSpreadsheet();
  } catch (e) {
    Logger.log('Esperando autorizaci√≥n de Spreadsheet: ' + e);
  }
  
  Logger.log('‚úÖ Permisos verificados. Ahora puedes desplegar la webapp.');
}
// MOD-001: FIN

// MOD-002: SERVIR HTML [INICIO]
function doGet(e) {
  const page = e.parameter.page || 'index';
  
  if (page === 'test') {
    return HtmlService.createHtmlOutputFromFile('testweb')
      .setTitle('CodeWorkShop - Tests')
      .setXFrameOptionsMode(HtmlService.XFrameOptionsMode.ALLOWALL);
  }
  
  return HtmlService.createTemplateFromFile('index')
    .evaluate()
    .setTitle('CodeWorkShop')
    .setXFrameOptionsMode(HtmlService.XFrameOptionsMode.ALLOWALL);
}
// MOD-002: FIN

// MOD-003: INCLUIR ARCHIVOS HTML [INICIO]
function include(filename) {
  return HtmlService.createHtmlOutputFromFile(filename).getContent();
}
// MOD-003: FIN

// MOD-004: PARSEAR M√ìDULOS [INICIO]
function parsearModulos(codigoCompleto) {
  try {
    if (!codigoCompleto || codigoCompleto.trim() === '') {
      return { success: false, error: 'C√≥digo vac√≠o' };
    }
    
    const modulosRegex = /\/\/\s*MOD-(\d{3}):\s*(.+?)\s*\[INICIO\]([\s\S]*?)\/\/\s*MOD-\1:\s*FIN/g;
    const modulos = [];
    let match;
    
    while ((match = modulosRegex.exec(codigoCompleto)) !== null) {
      modulos.push({
        numero: match[1],
        descripcion: match[2].trim(),
        codigo: match[0],
        inicio: match.index,
        fin: match.index + match[0].length
      });
    }
    
    if (modulos.length === 0) {
      return { success: false, error: 'No se detectaron m√≥dulos v√°lidos' };
    }
    
    Logger.log('‚úÖ M√≥dulos parseados: ' + modulos.length);
    return { success: true, modulos: modulos };
    
  } catch (error) {
    Logger.log('‚ùå Error en parsearModulos: ' + error.message);
    return { success: false, error: error.message };
  }
}
// MOD-004: FIN

// MOD-005: EXTRAER HEADER [INICIO]
function extraerHeader(codigoCompleto) {
  try {
    const headerRegex = /\/\*\*[\s\S]*?PROYECTO:\s*(.+?)[\s\S]*?ARCHIVO:\s*(.+?)[\s\S]*?VERSI√ìN:\s*(.+?)[\s\S]*?FECHA:\s*(.+?)\*\//;
    const match = codigoCompleto.match(headerRegex);
    
    if (!match) {
      return { success: false, error: 'Header no encontrado' };
    }
    
    const header = {
      proyecto: match[1].trim(),
      archivo: match[2].trim(),
      version: match[3].trim(),
      fecha: match[4].trim()
    };
    
    Logger.log('‚úÖ Header extra√≠do: ' + header.proyecto);
    return { success: true, header: header };
    
  } catch (error) {
    Logger.log('‚ùå Error en extraerHeader: ' + error.message);
    return { success: false, error: error.message };
  }
}
// MOD-005: FIN

// MOD-006: VALIDAR M√ìDULO [INICIO]
function validarModulo(codigoModulo, numeroEsperado) {
  try {
    const inicioRegex = new RegExp(`\\/\\/\\s*MOD-${numeroEsperado}:\\s*.+?\\s*\\[INICIO\\]`);
    if (!inicioRegex.test(codigoModulo)) {
      return { success: false, error: `Falta [INICIO] en MOD-${numeroEsperado}` };
    }
    
    const finRegex = new RegExp(`\\/\\/\\s*MOD-${numeroEsperado}:\\s*FIN`);
    if (!finRegex.test(codigoModulo)) {
      return { success: false, error: `Falta FIN en MOD-${numeroEsperado}` };
    }
    
    return { success: true };
    
  } catch (error) {
    Logger.log('‚ùå Error en validarModulo: ' + error.message);
    return { success: false, error: error.message };
  }
}
// MOD-006: FIN

// MOD-007: REEMPLAZAR M√ìDULO [INICIO]
function reemplazarModulo(codigoCompleto, numeroModulo, nuevoCodigoModulo) {
  try {
    if (!codigoCompleto || !numeroModulo || !nuevoCodigoModulo) {
      return { success: false, error: 'Par√°metros incompletos' };
    }
    
    const validacion = validarModulo(nuevoCodigoModulo, numeroModulo);
    if (!validacion.success) {
      return validacion;
    }
    
    const moduloRegex = new RegExp(
      `\\/\\/\\s*MOD-${numeroModulo}:\\s*.+?\\s*\\[INICIO\\][\\s\\S]*?\\/\\/\\s*MOD-${numeroModulo}:\\s*FIN`,
      'g'
    );
    
    if (!moduloRegex.test(codigoCompleto)) {
      return { success: false, error: `M√≥dulo MOD-${numeroModulo} no encontrado en el c√≥digo original` };
    }
    
    const codigoActualizado = codigoCompleto.replace(moduloRegex, nuevoCodigoModulo.trim());
    
    const headerResult = extraerHeader(codigoCompleto);
    if (headerResult.success) {
      const codigoConVersionActualizada = actualizarVersion(codigoActualizado, headerResult.header);
      Logger.log('‚úÖ M√≥dulo MOD-' + numeroModulo + ' reemplazado exitosamente');
      return { success: true, codigo: codigoConVersionActualizada };
    }
    
    Logger.log('‚úÖ M√≥dulo MOD-' + numeroModulo + ' reemplazado (sin actualizar versi√≥n)');
    return { success: true, codigo: codigoActualizado };
    
  } catch (error) {
    Logger.log('‚ùå Error en reemplazarModulo: ' + error.message);
    return { success: false, error: error.message };
  }
}
// MOD-007: FIN

// MOD-008: ACTUALIZAR VERSI√ìN [INICIO]
function actualizarVersion(codigo, headerActual) {
  try {
    const versionParts = headerActual.version.split('.');
    if (versionParts.length === 3) {
      versionParts[2] = String(parseInt(versionParts[2]) + 1);
      const nuevaVersion = versionParts.join('.');
      
      const ahora = new Date();
      const opciones = { 
        timeZone: 'America/Lima',
        year: 'numeric',
        month: '2-digit',
        day: '2-digit',
        hour: '2-digit',
        minute: '2-digit',
        hour12: false
      };
      
      const fechaFormateada = ahora.toLocaleString('es-PE', opciones)
        .replace(/(\d+)\/(\d+)\/(\d+),?\s*(\d+):(\d+)/, '$1/$2/$3 $4:$5');
      
      const nuevaFecha = fechaFormateada + ' (UTC-5)';
      
      const headerRegex = /\/\*\*[\s\S]*?VERSI√ìN:\s*(.+?)[\s\S]*?FECHA:\s*(.+?)\*\//;
      const codigoActualizado = codigo.replace(headerRegex, function(match) {
        return match
          .replace(/VERSI√ìN:\s*(.+?)[\s\S]/, `VERSI√ìN: ${nuevaVersion}                                        ‚ïë\n`)
          .replace(/FECHA:\s*(.+?)\*\//, `FECHA: ${nuevaFecha}                         ‚ïë\n * ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\n */`);
      });
      
      Logger.log('‚úÖ Versi√≥n actualizada: ' + headerActual.version + ' ‚Üí ' + nuevaVersion);
      return codigoActualizado;
    }
    
    return codigo;
    
  } catch (error) {
    Logger.log('‚ö†Ô∏è No se pudo actualizar versi√≥n: ' + error.message);
    return codigo;
  }
}
// MOD-008: FIN


// ============================================
// ARCHIVO 2/7: index.html
// URL: https://raw.githubusercontent.com/koki81pe/CodeWorkShop/refs/heads/main/index.html
// ============================================

<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CodeWorkShop</title>
  <?!= include('style'); ?>
</head>
<body>
  <div class="container">
    <!-- Header con bot√≥n de instrucciones -->
    <div class="main-header">
      <div class="header-content">
        <h1>üîß CodeWorkShop</h1>
        <p class="subtitle">Modificaci√≥n modular y quir√∫rgica de c√≥digo</p>
      </div>
      <div class="header-actions">
        <button class="btn-secondary" onclick="copiarInstruccionesIA()" 
                title="Copia las instrucciones para entrenar IAs en el formato de modulaci√≥n">
          üìã Copiar Instrucciones para IA
        </button>
      </div>
    </div>

    <!-- Secci√≥n de carga de c√≥digo -->
    <div class="section">
      <h2>1. Cargar C√≥digo Original</h2>
      <textarea id="codigoOriginal" 
                class="code-area" 
                placeholder="Pega aqu√≠ tu c√≥digo con m√≥dulos MOD-XXX..."></textarea>
      <button class="btn-primary" onclick="analizarModulos()">
        üîç Analizar M√≥dulos
      </button>
    </div>

    <!-- Lista de m√≥dulos detectados -->
    <div class="section" id="seccionModulos" style="display:none;">
      <h2>2. Seleccionar M√≥dulo a Modificar</h2>
      <div id="listaModulos" class="modulo-list"></div>
    </div>

    <!-- C√≥digo del m√≥dulo seleccionado -->
    <div class="section" id="seccionModuloActual" style="display:none;">
      <h2>3. C√≥digo Actual del M√≥dulo</h2>
      <textarea id="moduloActual" 
                class="code-area" 
                readonly></textarea>
    </div>

    <!-- Nuevo c√≥digo del m√≥dulo -->
    <div class="section" id="seccionNuevoModulo" style="display:none;">
      <h2>4. Nuevo C√≥digo del M√≥dulo</h2>
      <textarea id="nuevoModulo" 
                class="code-area" 
                placeholder="Pega aqu√≠ el nuevo c√≥digo del m√≥dulo MOD-XXX..."></textarea>
      <button class="btn-primary" onclick="aplicarCambio()">
        ‚úÖ Aplicar Cambio
      </button>
    </div>

    <!-- C√≥digo resultante -->
    <div class="section" id="seccionResultado" style="display:none;">
      <h2>5. C√≥digo Resultante</h2>
      <textarea id="codigoResultante" 
                class="code-area" 
                readonly></textarea>
      <button class="btn-secondary" onclick="copiarResultado()">
        üìã Copiar C√≥digo
      </button>
      <button class="btn-secondary" onclick="reiniciar()">
        üîÑ Nueva Modificaci√≥n
      </button>
    </div>

    <!-- Toast de notificaciones -->
    <div id="toast" class="toast"></div>

    <!-- Loading overlay -->
    <div id="loading" class="loading-overlay">
      <div class="spinner"></div>
      <p>Procesando...</p>
    </div>
  </div>

  <?!= include('scripts'); ?>
</body>
</html>


// ============================================
// ARCHIVO 3/7: scritps.html
// URL: https://raw.githubusercontent.com/koki81pe/CodeWorkShop/refs/heads/main/scritps.html
// ============================================

<script>
// Variables globales
let codigoOriginal = '';
let modulosDetectados = [];
let moduloSeleccionado = null;

// Constante con instrucciones para IA
const INSTRUCCIONES_IA = `# üîß INSTRUCCIONES DE MODULACI√ìN DE C√ìDIGO - CodeWorkShop

Para que el c√≥digo sea compatible con CodeWorkShop, sigue EXACTAMENTE estas reglas:

## üìã HEADER OBLIGATORIO

Todo archivo de c√≥digo DEBE iniciar con:

\`\`\`
/**
 * ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
 * ‚ïë PROYECTO: [Nombre del Proyecto]                         ‚ïë
 * ‚ïë ARCHIVO: [NombreArchivo.gs]                             ‚ïë
 * ‚ïë VERSI√ìN: [X.Y.Z]                                        ‚ïë
 * ‚ïë FECHA: [DD/MM/AAAA HH:MM (UTC-5)]                       ‚ïë
 * ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
 */
\`\`\`

**Ejemplo real:**
\`\`\`
/**
 * ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
 * ‚ïë PROYECTO: Sistema de Facturaci√≥n                        ‚ïë
 * ‚ïë ARCHIVO: facturacion.gs                                 ‚ïë
 * ‚ïë VERSI√ìN: 2.3.1                                          ‚ïë
 * ‚ïë FECHA: 09/01/2026 14:30 (UTC-5)                         ‚ïë
 * ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
 */
\`\`\`

---

## üß© MODULACI√ìN DE FUNCIONES

Cada funci√≥n o secci√≥n l√≥gica DEBE estar delimitada as√≠:

\`\`\`
// MOD-001: DESCRIPCI√ìN EN MAY√öSCULAS [INICIO]
function miFuncion() {
  // c√≥digo aqu√≠
}
// MOD-001: FIN
\`\`\`

**Ejemplo completo:**
\`\`\`
// MOD-001: VALIDACI√ìN DE DATOS [INICIO]
function validarDatos(datos) {
  if (!datos || datos.length === 0) {
    throw new Error("Datos vac√≠os");
  }
  return true;
}
// MOD-001: FIN

// MOD-002: PROCESAMIENTO PRINCIPAL [INICIO]
function procesarFactura(factura) {
  validarDatos(factura);
  const resultado = calcularTotal(factura);
  return resultado;
}
// MOD-002: FIN

// MOD-003: C√ÅLCULO DE TOTALES [INICIO]
function calcularTotal(factura) {
  return factura.items.reduce((sum, item) => sum + item.precio, 0);
}
// MOD-003: FIN
\`\`\`

---

## ‚ö†Ô∏è REGLAS CR√çTICAS

### 1. Numeraci√≥n Secuencial
- ‚úÖ Usar: MOD-001, MOD-002, MOD-003...
- ‚ùå NO saltar n√∫meros: MOD-001, MOD-005, MOD-003
- ‚ùå NO repetir n√∫meros

### 2. Etiquetas Obligatorias
- **[INICIO]** es OBLIGATORIO (con corchetes)
- **FIN** DEBE tener el MISMO n√∫mero que INICIO
- Ejemplo correcto:
  \`\`\`
  // MOD-007: FUNCI√ìN [INICIO]
  function test() {}
  // MOD-007: FIN
  \`\`\`

### 3. Descripci√≥n
- Siempre en MAY√öSCULAS
- Clara y concisa
- Describe la funci√≥n del m√≥dulo

### 4. NO usar MOD-XXX dentro del c√≥digo
- ‚ùå Incorrecto:
  \`\`\`
  // MOD-001: FUNCI√ìN [INICIO]
  function test() {
    // Este es el MOD-001 que hace... ‚Üê NO HACER ESTO
  }
  // MOD-001: FIN
  \`\`\`
- ‚úÖ Correcto:
  \`\`\`
  // MOD-001: FUNCI√ìN [INICIO]
  function test() {
    // Esta funci√≥n valida los datos de entrada
  }
  // MOD-001: FIN
  \`\`\`

---

## üîÑ CUANDO MODIFICAS C√ìDIGO EXISTENTE

**REGLA DE ORO:** Si el c√≥digo YA tiene m√≥dulos, SOLO entrega el m√≥dulo modificado.

### ‚ùå INCORRECTO - NO hagas esto:
\`\`\`
[Usuario pide modificar la funci√≥n de validaci√≥n]

[IA responde con TODO el archivo completo de 500 l√≠neas]
\`\`\`

### ‚úÖ CORRECTO - Haz esto:
\`\`\`
[Usuario pide modificar la funci√≥n de validaci√≥n]

[IA responde SOLO con:]

// MOD-001: VALIDACI√ìN DE DATOS [INICIO]
function validarDatos(datos) {
  // NUEVA l√≥gica de validaci√≥n mejorada
  if (!datos) throw new Error("Datos nulos");
  if (!Array.isArray(datos)) throw new Error("Datos no son array");
  return true;
}
// MOD-001: FIN
\`\`\`

**El usuario usar√° CodeWorkShop para reemplazar SOLO ese m√≥dulo en el c√≥digo completo.**

---

## üéØ RESUMEN R√ÅPIDO

**Siempre incluye:**
1. Header con PROYECTO, ARCHIVO, VERSI√ìN, FECHA
2. M√≥dulos con MOD-XXX: DESCRIPCI√ìN [INICIO]
3. Cierre con MOD-XXX: FIN (mismo n√∫mero)
4. Numeraci√≥n secuencial sin saltos

**Cuando modificas:**
- SOLO entrega el m√≥dulo modificado
- Mant√©n el n√∫mero MOD-XXX original
- Incluye [INICIO] y FIN completos

**Nunca hagas:**
- Entregar todo el archivo si solo se modific√≥ una funci√≥n
- Cambiar n√∫meros de m√≥dulos existentes
- Olvidar [INICIO] o FIN
- Usar MOD-XXX dentro de comentarios de c√≥digo

---

‚úÖ **Listo para usar con CodeWorkShop**`;

// MOD-001: COPIAR INSTRUCCIONES IA [INICIO]
function copiarInstruccionesIA() {
  if (navigator.clipboard && navigator.clipboard.writeText) {
    navigator.clipboard.writeText(INSTRUCCIONES_IA)
      .then(() => {
        mostrarNotificacion('‚úÖ Instrucciones copiadas al portapapeles', 'success');
        console.log('üìã Instrucciones IA copiadas correctamente');
      })
      .catch(err => {
        copiarInstruccionesFallback();
      });
  } else {
    copiarInstruccionesFallback();
  }
}

function copiarInstruccionesFallback() {
  const textarea = document.createElement('textarea');
  textarea.value = INSTRUCCIONES_IA;
  textarea.style.position = 'fixed';
  textarea.style.opacity = '0';
  document.body.appendChild(textarea);
  textarea.select();
  
  try {
    const exitoso = document.execCommand('copy');
    if (exitoso) {
      mostrarNotificacion('‚úÖ Instrucciones copiadas al portapapeles', 'success');
      console.log('üìã Instrucciones IA copiadas (fallback)');
    } else {
      throw new Error('execCommand fall√≥');
    }
  } catch (err) {
    mostrarNotificacion('‚ùå No se pudo copiar. Usa Ctrl+C manualmente', 'error');
    console.error('Error al copiar:', err);
    mostrarModalInstrucciones();
  } finally {
    document.body.removeChild(textarea);
  }
}

function mostrarModalInstrucciones() {
  const modal = document.createElement('div');
  modal.className = 'modal-instrucciones';
  modal.innerHTML = `
    <div class="modal-content">
      <h3>üìã Instrucciones para IA</h3>
      <p>Selecciona todo el texto y copia con Ctrl+C:</p>
      <textarea readonly style="width:100%; height:400px; font-family:monospace;">
${INSTRUCCIONES_IA}
      </textarea>
      <button onclick="this.closest('.modal-instrucciones').remove()">Cerrar</button>
    </div>
  `;
  document.body.appendChild(modal);
}
// MOD-001: FIN

// MOD-002: ANALIZAR M√ìDULOS [INICIO]
function analizarModulos() {
  const codigo = document.getElementById('codigoOriginal').value;
  
  if (!codigo.trim()) {
    mostrarNotificacion('‚ö†Ô∏è Por favor, carga el c√≥digo primero', 'warning');
    return;
  }
  
  if (!codigo.includes('MOD-')) {
    mostrarNotificacion('‚ö†Ô∏è No se detectaron m√≥dulos en el c√≥digo', 'warning');
    return;
  }
  
  mostrarCargando(true);
  console.log('üì• C√≥digo cargado:', codigo.length, 'caracteres');
  
  google.script.run
    .withSuccessHandler(function(resultado) {
      mostrarCargando(false);
      
      if (!resultado.success) {
        mostrarNotificacion(resultado.error, 'error');
        console.error('Error al parsear:', resultado);
        return;
      }
      
      codigoOriginal = codigo;
      modulosDetectados = resultado.modulos;
      mostrarModulos(resultado.modulos);
      mostrarNotificacion('‚úÖ M√≥dulos detectados: ' + resultado.modulos.length, 'success');
      console.log('üîç M√≥dulos detectados:', resultado.modulos);
    })
    .withFailureHandler(function(error) {
      mostrarCargando(false);
      mostrarNotificacion('‚ùå Error de conexi√≥n', 'error');
      console.error('Error fatal:', error);
    })
    .parsearModulos(codigo);
}
// MOD-002: FIN

// MOD-003: MOSTRAR M√ìDULOS [INICIO]
function mostrarModulos(modulos) {
  const lista = document.getElementById('listaModulos');
  lista.innerHTML = '';
  
  modulos.forEach((modulo, index) => {
    const item = document.createElement('div');
    item.className = 'modulo-item';
    item.onclick = () => seleccionarModulo(index);
    
    item.innerHTML = `
      <span class="modulo-numero">MOD-${modulo.numero}</span>
      <span class="modulo-descripcion">${modulo.descripcion}</span>
    `;
    
    lista.appendChild(item);
  });
  
  document.getElementById('seccionModulos').style.display = 'block';
}
// MOD-003: FIN

// MOD-004: SELECCIONAR M√ìDULO [INICIO]
function seleccionarModulo(index) {
  moduloSeleccionado = modulosDetectados[index];
  
  document.querySelectorAll('.modulo-item').forEach((item, i) => {
    if (i === index) {
      item.classList.add('selected');
    } else {
      item.classList.remove('selected');
    }
  });
  
  document.getElementById('moduloActual').value = moduloSeleccionado.codigo;
  document.getElementById('seccionModuloActual').style.display = 'block';
  document.getElementById('seccionNuevoModulo').style.display = 'block';
  
  mostrarNotificacion('‚úÖ M√≥dulo MOD-' + moduloSeleccionado.numero + ' seleccionado', 'info');
  console.log('üìå M√≥dulo seleccionado:', moduloSeleccionado);
}
// MOD-004: FIN

// MOD-005: APLICAR CAMBIO [INICIO]
function aplicarCambio() {
  if (!validarAntesDeEnviar()) {
    return;
  }
  
  const nuevoModulo = document.getElementById('nuevoModulo').value;
  
  mostrarCargando(true);
  console.log('üîÑ Aplicando cambio al m√≥dulo MOD-' + moduloSeleccionado.numero);
  
  google.script.run
    .withSuccessHandler(function(resultado) {
      mostrarCargando(false);
      
      if (!resultado.success) {
        mostrarNotificacion(resultado.error, 'error');
        console.error('Error al reemplazar:', resultado);
        return;
      }
      
      document.getElementById('codigoResultante').value = resultado.codigo;
      document.getElementById('seccionResultado').style.display = 'block';
      mostrarNotificacion('‚úÖ Cambio aplicado correctamente', 'success');
      console.log('‚úÖ C√≥digo actualizado');
      
      document.getElementById('codigoResultante').scrollIntoView({ behavior: 'smooth' });
    })
    .withFailureHandler(function(error) {
      mostrarCargando(false);
      mostrarNotificacion('‚ùå Error al aplicar cambio', 'error');
      console.error('Error fatal:', error);
    })
    .reemplazarModulo(codigoOriginal, moduloSeleccionado.numero, nuevoModulo);
}
// MOD-005: FIN

// MOD-006: VALIDAR ANTES DE ENVIAR [INICIO]
function validarAntesDeEnviar() {
  if (!codigoOriginal) {
    mostrarNotificacion('‚ö†Ô∏è Primero carga el c√≥digo original', 'warning');
    return false;
  }
  
  if (!moduloSeleccionado) {
    mostrarNotificacion('‚ö†Ô∏è Selecciona un m√≥dulo', 'warning');
    return false;
  }
  
  const nuevoCodigo = document.getElementById('nuevoModulo').value;
  if (!nuevoCodigo.trim()) {
    mostrarNotificacion('‚ö†Ô∏è El nuevo c√≥digo est√° vac√≠o', 'warning');
    return false;
  }
  
  return true;
}
// MOD-006: FIN

// MOD-007: COPIAR RESULTADO [INICIO]
function copiarResultado() {
  const codigo = document.getElementById('codigoResultante').value;
  
  if (navigator.clipboard && navigator.clipboard.writeText) {
    navigator.clipboard.writeText(codigo)
      .then(() => {
        mostrarNotificacion('‚úÖ C√≥digo copiado al portapapeles', 'success');
      })
      .catch(() => {
        copiarResultadoFallback();
      });
  } else {
    copiarResultadoFallback();
  }
}

function copiarResultadoFallback() {
  const textarea = document.getElementById('codigoResultante');
  textarea.select();
  
  try {
    document.execCommand('copy');
    mostrarNotificacion('‚úÖ C√≥digo copiado al portapapeles', 'success');
  } catch (err) {
    mostrarNotificacion('‚ùå No se pudo copiar', 'error');
  }
}
// MOD-007: FIN

// MOD-008: REINICIAR [INICIO]
function reiniciar() {
  document.getElementById('codigoOriginal').value = '';
  document.getElementById('nuevoModulo').value = '';
  document.getElementById('codigoResultante').value = '';
  
  document.getElementById('seccionModulos').style.display = 'none';
  document.getElementById('seccionModuloActual').style.display = 'none';
  document.getElementById('seccionNuevoModulo').style.display = 'none';
  document.getElementById('seccionResultado').style.display = 'none';
  
  codigoOriginal = '';
  modulosDetectados = [];
  moduloSeleccionado = null;
  
  mostrarNotificacion('üîÑ Listo para nueva modificaci√≥n', 'info');
  console.log('üîÑ Aplicaci√≥n reiniciada');
}
// MOD-008: FIN

// MOD-009: NOTIFICACIONES [INICIO]
function mostrarNotificacion(mensaje, tipo = 'success') {
  const toast = document.getElementById('toast');
  const iconos = {
    success: '‚úÖ',
    error: '‚ùå',
    warning: '‚ö†Ô∏è',
    info: '‚ÑπÔ∏è'
  };
  
  toast.innerHTML = `${iconos[tipo]} ${mensaje}`;
  toast.className = `toast ${tipo} show`;
  
  setTimeout(() => {
    toast.className = 'toast';
  }, 3000);
}
// MOD-009: FIN

// MOD-010: LOADING OVERLAY [INICIO]
function mostrarCargando(mostrar) {
  const loading = document.getElementById('loading');
  if (mostrar) {
    loading.classList.add('show');
  } else {
    loading.classList.remove('show');
  }
}
// MOD-010: FIN
</script>


// ============================================
// ARCHIVO 4/7: style.html
// URL: https://raw.githubusercontent.com/koki81pe/CodeWorkShop/refs/heads/main/style.html
// ============================================

<style>
/* Variables de color - GitHub Dark */
:root {
  /* Fondos */
  --bg-primary: #0d1117;
  --bg-secondary: #161b22;
  --bg-tertiary: #21262d;
  
  /* Bordes */
  --border-primary: #30363d;
  --border-secondary: #21262d;
  
  /* Textos */
  --text-primary: #c9d1d9;
  --text-secondary: #8b949e;
  --text-tertiary: #6e7681;
  
  /* Acentos */
  --accent-blue: #58a6ff;
  --accent-green: #238636;
  --accent-green-hover: #2ea043;
  --accent-green-pressed: #1f6f2c;
  --accent-red: #da3633;
  --accent-yellow: #d29922;
  
  /* Estados */
  --success: #238636;
  --error: #da3633;
  --warning: #d29922;
  --info: #1f6feb;
}

/* Reset y base */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans', Helvetica, Arial, sans-serif;
  background: var(--bg-primary);
  color: var(--text-primary);
  line-height: 1.6;
  padding: 0;
  margin: 0;
}

/* Container principal */
.container {
  max-width: 1400px;
  margin: 0 auto;
  padding: 16px;
}

/* Header */
.main-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
  padding-bottom: 16px;
  border-bottom: 1px solid var(--border-primary);
  flex-wrap: wrap;
  gap: 16px;
}

.header-content h1 {
  font-size: 28px;
  font-weight: 600;
  margin-bottom: 4px;
}

.subtitle {
  color: var(--text-secondary);
  font-size: 14px;
  margin: 0;
}

.header-actions {
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
}

/* Secciones */
.section {
  background: var(--bg-secondary);
  border: 1px solid var(--border-primary);
  border-radius: 6px;
  padding: 20px;
  margin-bottom: 20px;
}

.section h2 {
  font-size: 18px;
  font-weight: 600;
  margin-bottom: 16px;
  color: var(--text-primary);
}

/* √Årea de c√≥digo */
.code-area {
  width: 100%;
  height: calc(100vh - 250px);
  min-height: 200px;
  max-height: 600px;
  padding: 12px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border-primary);
  border-radius: 6px;
  color: var(--text-primary);
  font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
  font-size: 13px;
  line-height: 1.5;
  resize: vertical;
  outline: none;
  transition: border-color 0.2s;
}

.code-area:focus {
  border-color: var(--accent-blue);
}

.code-area::placeholder {
  color: var(--text-tertiary);
}

/* Botones */
button {
  padding: 8px 16px;
  border-radius: 6px;
  border: none;
  cursor: pointer;
  font-size: 14px;
  font-weight: 500;
  transition: all 0.2s;
  outline: none;
}

.btn-primary {
  background: var(--accent-green);
  color: white;
}

.btn-secondary {
  background: var(--bg-tertiary);
  color: var(--text-primary);
  border: 1px solid var(--border-primary);
}

/* Hover solo en dispositivos con puntero */
@media (hover: hover) {
  .btn-primary:hover {
    background: var(--accent-green-hover);
  }
  
  .btn-secondary:hover {
    background: var(--bg-secondary);
    border-color: var(--accent-blue);
  }
}

/* T√°ctil en m√≥viles */
@media (hover: none) {
  .btn-primary:active {
    background: var(--accent-green-pressed);
    transform: scale(0.98);
  }
  
  .btn-secondary:active {
    background: var(--bg-secondary);
    transform: scale(0.98);
  }
}

/* Lista de m√≥dulos */
.modulo-list {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.modulo-item {
  background: var(--bg-tertiary);
  border: 1px solid var(--border-primary);
  border-radius: 6px;
  padding: 12px 16px;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  gap: 12px;
}

.modulo-item:hover {
  border-color: var(--accent-blue);
  background: var(--bg-primary);
}

.modulo-item.selected {
  border-color: var(--accent-green);
  background: var(--bg-primary);
}

.modulo-numero {
  font-weight: 600;
  color: var(--accent-blue);
  font-family: 'Consolas', 'Monaco', monospace;
}

.modulo-descripcion {
  flex: 1;
  color: var(--text-primary);
}

/* Toast de notificaciones */
.toast {
  position: fixed;
  bottom: -100px;
  left: 50%;
  transform: translateX(-50%);
  background: var(--bg-tertiary);
  color: var(--text-primary);
  padding: 12px 24px;
  border-radius: 6px;
  border: 1px solid var(--border-primary);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
  transition: bottom 0.3s;
  z-index: 10000;
  font-size: 14px;
  max-width: 90%;
}

.toast.show {
  bottom: 24px;
}

.toast.success {
  border-color: var(--success);
  background: rgba(35, 134, 54, 0.1);
}

.toast.error {
  border-color: var(--error);
  background: rgba(218, 54, 51, 0.1);
}

.toast.warning {
  border-color: var(--warning);
  background: rgba(210, 153, 34, 0.1);
}

.toast.info {
  border-color: var(--info);
  background: rgba(31, 111, 235, 0.1);
}

/* Loading overlay */
.loading-overlay {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(13, 17, 23, 0.8);
  backdrop-filter: blur(4px);
  z-index: 9999;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  gap: 16px;
}

.loading-overlay.show {
  display: flex;
}

.spinner {
  width: 40px;
  height: 40px;
  border: 3px solid var(--border-primary);
  border-top-color: var(--accent-blue);
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

.loading-overlay p {
  color: var(--text-secondary);
  font-size: 14px;
}

/* Modal de instrucciones */
.modal-instrucciones {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(0, 0, 0, 0.8);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
  padding: 20px;
}

.modal-content {
  background: var(--bg-primary);
  border: 1px solid var(--border-primary);
  border-radius: 8px;
  padding: 24px;
  max-width: 90%;
  max-height: 90%;
  overflow: auto;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5);
}

.modal-content h3 {
  margin-bottom: 16px;
  color: var(--text-primary);
}

.modal-content p {
  color: var(--text-secondary);
  margin-bottom: 12px;
}

.modal-content textarea {
  background: var(--bg-secondary);
  color: var(--text-primary);
  border: 1px solid var(--border-primary);
  border-radius: 4px;
  padding: 12px;
  margin: 16px 0;
  font-family: 'Consolas', 'Monaco', monospace;
  font-size: 12px;
  line-height: 1.5;
}

.modal-content button {
  background: var(--accent-blue);
  color: white;
  border: none;
  padding: 10px 20px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 14px;
}

/* Responsive - Mobile */
@media (max-width: 1023px) {
  .container {
    padding: 12px;
  }
  
  .main-header {
    flex-direction: column;
    align-items: flex-start;
  }
  
  .header-actions {
    width: 100%;
  }
  
  .header-actions button {
    width: 100%;
    padding: 12px;
    font-size: 16px;
  }
  
  .code-area {
    height: 300px;
    font-size: 14px;
  }
  
  button:not(.btn-secondary) {
    width: 100%;
    padding: 12px;
    font-size: 16px;
  }
  
  .section {
    padding: 16px;
  }
}

/* Responsive - Desktop */
@media (min-width: 1024px) {
  .header-actions button {
    width: auto;
  }
  
  button {
    width: auto;
  }
}
</style>


// ============================================
// ARCHIVO 5/7: testback.gs
// URL: https://raw.githubusercontent.com/koki81pe/CodeWorkShop/refs/heads/main/testback.gs
// ============================================

/**
 * ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
 * ‚ïë PROYECTO: CodeWorkShop                                   ‚ïë
 * ‚ïë ARCHIVO: testback.gs                                     ‚ïë
 * ‚ïë VERSI√ìN: 1.0.1                                          ‚ïë
 * ‚ïë FECHA: 09/01/2026 15:30 (UTC-5)                         ‚ïë
 * ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
 */

// MOD-001: EJECUTAR TODOS LOS TESTS [INICIO]
function allBack() {
  limpiarTests();
  
  try {
    DriveApp.getRootFolder();
  } catch (e) {
    return 'ERROR: Se requieren permisos. Ejecuta forzarPermisos() primero.';
  }
  
  const logs = [];
  logs.push('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');
  logs.push('TESTS DEL BACKEND');
  logs.push('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n');
  
  logs.push(...testParsearModulos());
  logs.push(...testExtraerHeader());
  logs.push(...testValidarModulo());
  logs.push(...testReemplazarModulo());
  
  logs.push('\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');
  logs.push('RESUMEN');
  logs.push('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');
  
  const total = logs.filter(l => l.includes('‚úÖ') || l.includes('‚ùå')).length;
  const exitosos = logs.filter(l => l.includes('‚úÖ')).length;
  const fallidos = logs.filter(l => l.includes('‚ùå')).length;
  
  logs.push(`Total: ${total} | Exitosos: ${exitosos} | Fallidos: ${fallidos}`);
  
  return logs.join('\n');
}
// MOD-001: FIN

// MOD-002: LIMPIAR TESTS [INICIO]
function limpiarTests() {
  Logger.log('Tests limpios - sin datos persistentes');
}
// MOD-002: FIN

// MOD-003: TEST PARSEAR M√ìDULOS [INICIO]
function testParsearModulos() {
  const logs = [];
  logs.push('TEST 1: Parsear M√≥dulos');
  logs.push('------------------------');
  
  const codigoPrueba = `/**
 * ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
 * ‚ïë PROYECTO: Test                                           ‚ïë
 * ‚ïë ARCHIVO: test.gs                                         ‚ïë
 * ‚ïë VERSI√ìN: 1.0.0                                          ‚ïë
 * ‚ïë FECHA: 09/01/2026 15:00 (UTC-5)                         ‚ïë
 * ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
 */

// MOD-001: FUNCI√ìN A [INICIO]
function funcionA() {
  return "A";
}
// MOD-001: FIN

// MOD-002: FUNCI√ìN B [INICIO]
function funcionB() {
  return "B";
}
// MOD-002: FIN`;

  try {
    const resultado = parsearModulos(codigoPrueba);
    
    if (resultado.success && resultado.modulos.length === 2) {
      logs.push('‚úÖ Detecta m√≥dulos correctamente');
      logs.push('   - M√≥dulos encontrados: ' + resultado.modulos.length);
      logs.push('   - MOD-001: ' + resultado.modulos[0].descripcion);
      logs.push('   - MOD-002: ' + resultado.modulos[1].descripcion);
    } else {
      logs.push('‚ùå Error al detectar m√≥dulos');
      logs.push('   - Esperado: 2 m√≥dulos');
      logs.push('   - Obtenido: ' + (resultado.modulos ? resultado.modulos.length : 0));
    }
  } catch (error) {
    logs.push('‚ùå Excepci√≥n: ' + error.message);
  }
  
  logs.push('');
  return logs;
}
// MOD-003: FIN

// MOD-004: TEST EXTRAER HEADER [INICIO]
function testExtraerHeader() {
  const logs = [];
  logs.push('TEST 2: Extraer Header');
  logs.push('------------------------');
  
  const codigoPrueba = `/**
 * ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
 * ‚ïë PROYECTO: MiProyecto                                     ‚ïë
 * ‚ïë ARCHIVO: codigo.gs                                       ‚ïë
 * ‚ïë VERSI√ìN: 2.1.5                                          ‚ïë
 * ‚ïë FECHA: 09/01/2026 14:30 (UTC-5)                         ‚ïë
 * ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
 */`;

  try {
    const resultado = extraerHeader(codigoPrueba);
    
    if (resultado.success) {
      const h = resultado.header;
      if (h.proyecto === 'MiProyecto' && h.version === '2.1.5') {
        logs.push('‚úÖ Header extra√≠do correctamente');
        logs.push('   - Proyecto: ' + h.proyecto);
        logs.push('   - Archivo: ' + h.archivo);
        logs.push('   - Versi√≥n: ' + h.version);
      } else {
        logs.push('‚ùå Datos del header incorrectos');
      }
    } else {
      logs.push('‚ùå No se pudo extraer header');
      logs.push('   - Error: ' + resultado.error);
    }
  } catch (error) {
    logs.push('‚ùå Excepci√≥n: ' + error.message);
  }
  
  logs.push('');
  return logs;
}
// MOD-004: FIN

// MOD-005: TEST VALIDAR M√ìDULO [INICIO]
function testValidarModulo() {
  const logs = [];
  logs.push('TEST 3: Validar M√≥dulo');
  logs.push('------------------------');
  
  const moduloValido = `// MOD-003: TEST V√ÅLIDO [INICIO]
function test() {
  return true;
}
// MOD-003: FIN`;

  const moduloInvalido = `// MOD-003: TEST INV√ÅLIDO [INICIO]
function test() {
  return false;
}`;

  try {
    const resultado1 = validarModulo(moduloValido, '003');
    const resultado2 = validarModulo(moduloInvalido, '003');
    
    if (resultado1.success && !resultado2.success) {
      logs.push('‚úÖ Validaci√≥n funciona correctamente');
      logs.push('   - M√≥dulo v√°lido: PASS');
      logs.push('   - M√≥dulo inv√°lido: FAIL (esperado)');
    } else {
      logs.push('‚ùå Error en validaci√≥n');
    }
  } catch (error) {
    logs.push('‚ùå Excepci√≥n: ' + error.message);
  }
  
  logs.push('');
  return logs;
}
// MOD-005: FIN

// MOD-006: TEST REEMPLAZAR M√ìDULO [INICIO]
function testReemplazarModulo() {
  const logs = [];
  logs.push('TEST 4: Reemplazar M√≥dulo');
  logs.push('------------------------');
  
  const codigoOriginal = `/**
 * ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
 * ‚ïë PROYECTO: Test                                           ‚ïë
 * ‚ïë ARCHIVO: test.gs                                         ‚ïë
 * ‚ïë VERSI√ìN: 1.0.0                                          ‚ïë
 * ‚ïë FECHA: 09/01/2026 15:00 (UTC-5)                         ‚ïë
 * ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
 */

// MOD-001: FUNCI√ìN ORIGINAL [INICIO]
function funcionOriginal() {
  return "original";
}
// MOD-001: FIN`;

  const nuevoModulo = `// MOD-001: FUNCI√ìN ORIGINAL [INICIO]
function funcionOriginal() {
  return "modificado";
}
// MOD-001: FIN`;

  try {
    const resultado = reemplazarModulo(codigoOriginal, '001', nuevoModulo);
    
    if (resultado.success && resultado.codigo.includes('modificado')) {
      logs.push('‚úÖ Reemplazo exitoso');
      logs.push('   - C√≥digo actualizado correctamente');
      logs.push('   - Versi√≥n incrementada');
    } else {
      logs.push('‚ùå Error en reemplazo');
      if (resultado.error) {
        logs.push('   - Error: ' + resultado.error);
      }
    }
  } catch (error) {
    logs.push('‚ùå Excepci√≥n: ' + error.message);
  }
  
  logs.push('');
  return logs;
}
// MOD-006: FIN


// ============================================
// ARCHIVO 6/7: testfront.gs
// URL: https://raw.githubusercontent.com/koki81pe/CodeWorkShop/refs/heads/main/testfront.gs
// ============================================

/**
 * ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
 * ‚ïë PROYECTO: CodeWorkShop                                   ‚ïë
 * ‚ïë ARCHIVO: testfront.gs                                    ‚ïë
 * ‚ïë VERSI√ìN: 1.0.1                                          ‚ïë
 * ‚ïë FECHA: 09/01/2026 15:30 (UTC-5)                         ‚ïë
 * ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
 */

// MOD-001: EJECUTAR TODOS LOS TESTS UI [INICIO]
function allFront() {
  limpiarTests();
  
  const logs = [];
  logs.push('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');
  logs.push('TESTS DEL FRONTEND');
  logs.push('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n');
  
  logs.push(...testSimularCarga());
  logs.push(...testSimularAnalisis());
  logs.push(...testSimularValidacion());
  
  logs.push('\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');
  logs.push('RESUMEN');
  logs.push('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');
  
  const total = logs.filter(l => l.includes('‚úÖ') || l.includes('‚ùå')).length;
  const exitosos = logs.filter(l => l.includes('‚úÖ')).length;
  const fallidos = logs.filter(l => l.includes('‚ùå')).length;
  
  logs.push(`Total: ${total} | Exitosos: ${exitosos} | Fallidos: ${fallidos}`);
  
  return logs.join('\n');
}
// MOD-001: FIN

// MOD-002: TEST SIMULAR CARGA [INICIO]
function testSimularCarga() {
  const logs = [];
  logs.push('TEST UI-1: Simular Carga de C√≥digo');
  logs.push('-----------------------------------');
  
  try {
    const codigoPrueba = `/**
 * ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
 * ‚ïë PROYECTO: Test UI                                        ‚ïë
 * ‚ïë ARCHIVO: test.gs                                         ‚ïë
 * ‚ïë VERSI√ìN: 1.0.0                                          ‚ïë
 * ‚ïë FECHA: 09/01/2026 15:00 (UTC-5)                         ‚ïë
 * ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
 */

// MOD-001: FUNCI√ìN TEST [INICIO]
function test() {
  return true;
}
// MOD-001: FIN`;

    if (codigoPrueba.length > 0) {
      logs.push('‚úÖ Carga de c√≥digo simulada');
      logs.push('   - Caracteres: ' + codigoPrueba.length);
      logs.push('   - Contiene header: ' + (codigoPrueba.includes('PROYECTO:') ? 'S√≠' : 'No'));
      logs.push('   - Contiene m√≥dulos: ' + (codigoPrueba.includes('MOD-') ? 'S√≠' : 'No'));
    } else {
      logs.push('‚ùå Error al simular carga');
    }
  } catch (error) {
    logs.push('‚ùå Excepci√≥n: ' + error.message);
  }
  
  logs.push('');
  return logs;
}
// MOD-002: FIN

// MOD-003: TEST SIMULAR AN√ÅLISIS [INICIO]
function testSimularAnalisis() {
  const logs = [];
  logs.push('TEST UI-2: Simular An√°lisis');
  logs.push('-----------------------------------');
  
  const codigoPrueba = `// MOD-001: TEST A [INICIO]
function a() {}
// MOD-001: FIN

// MOD-002: TEST B [INICIO]
function b() {}
// MOD-002: FIN`;

  try {
    const resultado = parsearModulos(codigoPrueba);
    
    if (resultado.success) {
      logs.push('‚úÖ An√°lisis ejecutado correctamente');
      logs.push('   - M√≥dulos detectados: ' + resultado.modulos.length);
      logs.push('   - Puede mostrar en lista: S√≠');
    } else {
      logs.push('‚ùå Error en an√°lisis');
      logs.push('   - Error: ' + resultado.error);
    }
  } catch (error) {
    logs.push('‚ùå Excepci√≥n: ' + error.message);
  }
  
  logs.push('');
  return logs;
}
// MOD-003: FIN

// MOD-004: TEST SIMULAR VALIDACI√ìN [INICIO]
function testSimularValidacion() {
  const logs = [];
  logs.push('TEST UI-3: Simular Validaci√≥n');
  logs.push('-----------------------------------');
  
  try {
    const checks = [];
    
    const codigoOriginal = '// c√≥digo existe';
    checks.push(codigoOriginal ? 'C√≥digo original' : null);
    
    const moduloSeleccionado = '001';
    checks.push(moduloSeleccionado ? 'M√≥dulo seleccionado' : null);
    
    const nuevoCodigo = '// MOD-001: TEST [INICIO]\n// MOD-001: FIN';
    checks.push(nuevoCodigo.trim() ? 'Nuevo c√≥digo' : null);
    
    const validas = checks.filter(c => c !== null).length;
    
    if (validas === 3) {
      logs.push('‚úÖ Validaci√≥n frontend correcta');
      logs.push('   - C√≥digo original: OK');
      logs.push('   - M√≥dulo seleccionado: OK');
      logs.push('   - Nuevo c√≥digo: OK');
    } else {
      logs.push('‚ùå Validaci√≥n incompleta');
      logs.push('   - Checks v√°lidos: ' + validas + '/3');
    }
  } catch (error) {
    logs.push('‚ùå Excepci√≥n: ' + error.message);
  }
  
  logs.push('');
  return logs;
}
// MOD-004: FIN


// ============================================
// ARCHIVO 7/7: testweb.html
// URL: https://raw.githubusercontent.com/koki81pe/CodeWorkShop/refs/heads/main/testweb.html
// ============================================

<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CodeWorkShop - Tests</title>
  <style>
    :root {
      --bg-primary: #0d1117;
      --bg-secondary: #161b22;
      --bg-tertiary: #21262d;
      --border-primary: #30363d;
      --text-primary: #c9d1d9;
      --text-secondary: #8b949e;
      --accent-blue: #58a6ff;
      --accent-green: #238636;
      --success: #238636;
      --error: #da3633;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans', Helvetica, Arial, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      padding: 20px;
      line-height: 1.6;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
    }
    
    h1 {
      font-size: 28px;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .subtitle {
      color: var(--text-secondary);
      font-size: 14px;
      margin-bottom: 24px;
    }
    
    .test-controls {
      display: flex;
      gap: 12px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }
    
    button {
      padding: 10px 20px;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.2s;
    }
    
    button.primary {
      background: var(--accent-green);
      color: white;
    }
    
    button.secondary {
      background: var(--bg-tertiary);
      color: var(--text-primary);
      border: 1px solid var(--border-primary);
    }
    
    button:hover {
      opacity: 0.9;
      transform: translateY(-1px);
    }
    
    button:active {
      transform: translateY(0);
    }
    
    .log-container {
      background: var(--bg-secondary);
      border: 1px solid var(--border-primary);
      border-radius: 6px;
      padding: 20px;
      min-height: 400px;
    }
    
    #logs {
      font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
      font-size: 13px;
      white-space: pre-wrap;
      word-wrap: break-word;
      color: var(--text-primary);
      line-height: 1.6;
    }
    
    .loading {
      display: none;
      text-align: center;
      padding: 20px;
      color: var(--text-secondary);
    }
    
    .loading.show {
      display: block;
    }
    
    .spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 2px solid var(--border-primary);
      border-top-color: var(--accent-blue);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    .toast {
      position: fixed;
      bottom: -100px;
      left: 50%;
      transform: translateX(-50%);
      background: var(--bg-tertiary);
      color: var(--text-primary);
      padding: 12px 24px;
      border-radius: 6px;
      border: 1px solid var(--border-primary);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
      transition: bottom 0.3s;
      z-index: 10000;
      font-size: 14px;
    }
    
    .toast.show {
      bottom: 24px;
    }
    
    .toast.success {
      border-color: var(--success);
      background: rgba(35, 134, 54, 0.1);
    }
    
    @media (max-width: 768px) {
      .test-controls {
        flex-direction: column;
      }
      
      button {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üß™ CodeWorkShop - Tests</h1>
    <p class="subtitle">Pruebas de Backend y Frontend</p>
    
    <div class="test-controls">
      <button class="primary" onclick="runBackendTests()">
        üîÑ Test Backend
      </button>
      <button class="primary" onclick="runFrontendTests()">
        üîÑ Test UI
      </button>
      <button class="secondary" onclick="clearLogs()">
        üóëÔ∏è Limpiar
      </button>
      <button class="secondary" onclick="copyLogs()">
        üìã Copiar Logs
      </button>
    </div>
    
    <div class="log-container">
      <div class="loading" id="loading">
        <div class="spinner"></div>
        <p>Ejecutando tests...</p>
      </div>
      <pre id="logs">Presiona un bot√≥n para ejecutar tests...</pre>
    </div>
    
    <div id="toast" class="toast"></div>
  </div>
  
  <script>
    function runBackendTests() {
      showLoading(true);
      clearLogs();
      
      google.script.run
        .withSuccessHandler(function(resultado) {
          showLoading(false);
          document.getElementById('logs').textContent = resultado;
          showToast('‚úÖ Tests del Backend completados');
        })
        .withFailureHandler(function(error) {
          showLoading(false);
          document.getElementById('logs').textContent = 'ERROR: ' + error.message;
          showToast('‚ùå Error al ejecutar tests');
        })
        .allBack();
    }
    
    function runFrontendTests() {
      showLoading(true);
      clearLogs();
      
      google.script.run
        .withSuccessHandler(function(resultado) {
          showLoading(false);
          document.getElementById('logs').textContent = resultado;
          showToast('‚úÖ Tests del Frontend completados');
        })
        .withFailureHandler(function(error) {
          showLoading(false);
          document.getElementById('logs').textContent = 'ERROR: ' + error.message;
          showToast('‚ùå Error al ejecutar tests');
        })
        .allFront();
    }
    
    function clearLogs() {
      document.getElementById('logs').textContent = 'Logs limpios. Presiona un bot√≥n para ejecutar tests...';
    }
    
    function copyLogs() {
      const logs = document.getElementById('logs').textContent;
      
      if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(logs)
          .then(() => {
            showToast('‚úÖ Logs copiados al portapapeles');
          })
          .catch(() => {
            copyLogsFallback();
          });
      } else {
        copyLogsFallback();
      }
    }
    
    function copyLogsFallback() {
      const textarea = document.createElement('textarea');
      const logs = document.getElementById('logs').textContent;
      textarea.value = logs;
      textarea.style.position = 'fixed';
      textarea.style.opacity = '0';
      document.body.appendChild(textarea);
      textarea.select();
      
      try {
        document.execCommand('copy');
        showToast('‚úÖ Logs copiados al portapapeles');
      } catch (err) {
        showToast('‚ùå No se pudo copiar');
      } finally {
        document.body.removeChild(textarea);
      }
    }
    
    function showLoading(show) {
      const loading = document.getElementById('loading');
      if (show) {
        loading.classList.add('show');
        document.getElementById('logs').style.display = 'none';
      } else {
        loading.classList.remove('show');
        document.getElementById('logs').style.display = 'block';
      }
    }
    
    function showToast(mensaje) {
      const toast = document.getElementById('toast');
      toast.textContent = mensaje;
      toast.classList.add('show');
      
      setTimeout(() => {
        toast.classList.remove('show');
      }, 3000);
    }
  </script>
</body>
</html>


// ============================================
// FIN DEL SOLID CODE
// Tama√±o total: 50,008 caracteres
// Archivos exitosos: 7/7
// ============================================
